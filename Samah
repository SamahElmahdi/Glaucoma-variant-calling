# Activate the enviornment
conda activate ngs1
# Create a directory for the tutorial
mkdir glaucomaproject && cd glaucomaproject
# Downloading and installing the SRA Toolkit
wget "http://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current/sratoolkit.current-centos_linux64.tar.gz"
tar -xzf sratoolkit.current-centos_linux64.tar.gz
sudo apt install sra-toolkit
mkdir sample_data && cd sample_data
# subsetting of data and splitting of reads using SRA Toolkit
fastq-dump -I --split-files -X 8000000 SRR5858162
# Run the FASTQC for each read 
for f in ~/glaucomaproject/sample_data/*.fastq;do fastqc -t 1 -f fastq -noextract $f;done
# Downloading the reference chromosome chr20
wget ftp://ftp.ensembl.org/pub/release-99/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.chromosome.20.fa.gz
gunzip -k Homo_sapiens.GRCh38.dna.chromosome.20.fa.gz
# Downloading whole genome annotation file
wget ftp://ftp.ensembl.org/pub/release-99/gtf/homo_sapiens/Homo_sapiens.GRCh38.99.chr.gtf.gz
gunzip -k Homo_sapiens.GRCh38.99.chr.gtf.gz
# Select only chr20 annotaion 
grep "^#" Homo_sapiens.GRCh38.99.chr.gtf > Homo_sapiens.GRCh38.99.chr_chr20.gtf
grep "^20" Homo_sapiens.GRCh38.99.chr.gtf >> Homo_sapiens.GRCh38.99.chr_chr20.gtf
